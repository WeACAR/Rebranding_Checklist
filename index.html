<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rebranding Checklist</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- ===== TOP BAR ===== -->
  <header class="top-bar">
    <div class="top-bar__left">
      <svg class="top-bar__icon" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
      <h1 class="top-bar__title">Rebranding Checklist</h1>
    </div>
    <div class="top-bar__actions">
      <span class="global-progress" id="globalProgress">0 / 0 tasks</span>
      <span class="save-indicator" id="saveIndicator" title="Your progress is auto-saved to browser cache">
        <svg viewBox="0 0 24 24" width="14" height="14"><path d="M17 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V7l-4-4zm-5 16a3 3 0 110-6 3 3 0 010 6zm3-10H5V5h10v4z"/></svg>
        <span id="saveTime">Not saved</span>
      </span>
      <button class="btn btn--edit" id="btnEditMode" title="Toggle edit mode">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 000-1.42l-2.34-2.34a1.003 1.003 0 00-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/></svg>
        <span>Edit Mode</span>
      </button>
      <button class="btn btn--outline btn--manage-criteria" id="btnManageCriteria" title="Manage predefined criteria">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.49.49 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.49.49 0 00-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1115.6 12 3.61 3.61 0 0112 15.6z"/></svg>
        <span>Manage Criteria</span>
      </button>
      <button class="btn btn--outline" id="btnImport" title="Import checklist from JSON">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"/></svg>
        <span>Import</span>
      </button>
      <button class="btn btn--outline" id="btnExport" title="Export checklist as JSON">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14a2 2 0 002-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2v9.67z"/></svg>
        <span>Export</span>
      </button>
      <button class="btn btn--outline" id="btnReset" title="Reset all checks">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
        <span>Reset</span>
      </button>
    </div>
  </header>

  <!-- ===== LEVEL 1 HORIZONTAL TABS ===== -->
  <nav class="level1-tabs" id="level1Tabs"></nav>

  <!-- ===== CONTENT AREA ===== -->
  <main class="content" id="content">
    <div class="empty-state" id="emptyState">
      <svg viewBox="0 0 24 24" width="64" height="64" opacity="0.3"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 7V3.5L18.5 9H13zM9 13h6v2H9v-2zm0 4h6v2H9v-2zm0-8h2v2H9V9z"/></svg>
      <p>No checklist loaded. Import a JSON checklist or use the sample below.</p>
      <button class="btn btn--primary" id="btnLoadSample">Load Sample Rebranding Checklist</button>
    </div>
    <div class="tree-container" id="treeContainer"></div>
  </main>

  <!-- ===== IMPORT MODAL ===== -->
  <div class="modal-overlay" id="importModal">
    <div class="modal">
      <div class="modal__header">
        <h2>Import Checklist</h2>
        <button class="modal__close" id="btnCloseModal">&times;</button>
      </div>
      <div class="modal__body">
        <div class="import-mode-section">
          <h3>What are you importing?</h3>
          <div class="import-mode-toggle">
            <button class="import-mode-btn import-mode-btn--active" id="btnModeAuto" data-mode="auto">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M19.36 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.64-4.96z"/></svg>
              Auto-Detect
            </button>
            <button class="import-mode-btn" id="btnModeFull" data-mode="full">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 7V3.5L18.5 9H13z"/></svg>
              Full Checklist
            </button>
            <button class="import-mode-btn" id="btnModeProject" data-mode="project">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"/></svg>
              Add Project(s)
            </button>
          </div>
          <p class="import-mode-hint" id="importModeHint">Auto-detect: will replace if full checklist, or append if project(s).</p>
        </div>
        <div class="import-section">
          <h3>Option 1: Upload JSON File</h3>
          <label class="file-upload">
            <input type="file" accept=".json" id="fileInput">
            <svg viewBox="0 0 24 24" width="24" height="24"><path d="M19.35 10.04A7.49 7.49 0 0012 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 000 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
            <span>Choose a .json file or drag &amp; drop</span>
          </label>
        </div>
        <div class="import-section">
          <h3>Option 2: Paste JSON</h3>
          <textarea id="jsonTextarea" rows="12" placeholder="Paste your JSON here..."></textarea>
          <button class="btn btn--primary" id="btnImportText" style="margin-top:8px;">Import from Text</button>
        </div>
        <details class="sample-section">
          <summary>View Full Checklist JSON Sample</summary>
          <p class="sample-desc">Use this format to import a complete checklist with all projects, pages, and criteria. This will <strong>replace</strong> any existing checklist.</p>
          <pre id="sampleJsonFull"></pre>
        </details>
        <details class="sample-section">
          <summary>View Project-Only JSON Sample</summary>
          <p class="sample-desc">Use this format to <strong>add one or more projects</strong> to your existing checklist without replacing it.</p>
          <pre id="sampleJsonProject"></pre>
        </details>
      </div>
    </div>
  </div>

  <!-- ===== PREDEFINED CRITERIA MODAL ===== -->
  <div class="modal-overlay" id="criteriaModal">
    <div class="modal modal--criteria">
      <div class="modal__header">
        <h2 id="criteriaModalTitle">Add Predefined Criteria</h2>
        <button class="modal__close" id="btnCloseCriteria">&times;</button>
      </div>
      <div class="modal__body">
        <p class="criteria-hint" id="criteriaHint">Select the criteria you want to add to this section.</p>
        <div class="criteria-actions">
          <button class="btn btn--outline btn--sm" id="btnSelectAll">Select All</button>
          <button class="btn btn--outline btn--sm" id="btnDeselectAll">Deselect All</button>
          <span class="criteria-count" id="criteriaCount">0 selected</span>
        </div>
        <div class="criteria-list" id="criteriaList"></div>
        <div class="criteria-empty" id="criteriaEmpty" style="display:none;">
          <svg viewBox="0 0 24 24" width="40" height="40"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
          <p>All predefined criteria have already been added to this section!</p>
        </div>
        <div class="criteria-footer">
          <button class="btn btn--primary" id="btnAddCriteria">Add Selected Criteria</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== RENAME / ADD PROMPT MODAL ===== -->
  <div class="modal-overlay" id="promptModal">
    <div class="modal modal--small">
      <div class="modal__header">
        <h2 id="promptTitle">Rename</h2>
        <button class="modal__close" id="btnClosePrompt">&times;</button>
      </div>
      <div class="modal__body">
        <input type="text" class="prompt-input" id="promptInput" placeholder="Enter name..." autocomplete="off">
        <div class="prompt-footer">
          <button class="btn btn--outline" id="btnCancelPrompt">Cancel</button>
          <button class="btn btn--primary" id="btnConfirmPrompt">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== CONFIRM DIALOG MODAL ===== -->
  <div class="modal-overlay" id="confirmModal">
    <div class="modal modal--small">
      <div class="modal__header">
        <h2 id="confirmTitle">Confirm</h2>
        <button class="modal__close" id="btnCloseConfirm">&times;</button>
      </div>
      <div class="modal__body">
        <p class="confirm-message" id="confirmMessage">Are you sure?</p>
        <div class="prompt-footer">
          <button class="btn btn--outline" id="btnCancelConfirm">Cancel</button>
          <button class="btn btn--danger" id="btnYesConfirm">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== MANAGE PREDEFINED CRITERIA MODAL ===== -->
  <div class="modal-overlay" id="manageCriteriaModal">
    <div class="modal modal--criteria">
      <div class="modal__header">
        <h2>Manage Predefined Criteria</h2>
        <button class="modal__close" id="btnCloseManageCriteria">&times;</button>
      </div>
      <div class="modal__body">
        <p class="criteria-hint">These are the reusable criteria available when clicking "Add Predefined Criteria" on any section. Add, rename, or remove items as needed.</p>
        <div class="manage-criteria-list" id="manageCriteriaList"></div>
        <div class="manage-criteria-add">
          <input type="text" class="prompt-input" id="newCriteriaInput" placeholder="Type a new criteria and press Enter or click Add..." autocomplete="off">
          <button class="btn btn--primary btn--sm" id="btnAddNewCriteria">Add</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
